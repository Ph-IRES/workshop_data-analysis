# TUTORIAL: QUERYING NCBI GENBANK WITH R

[NCBI](https://en.wikipedia.org/wiki/National_Center_for_Biotechnology_Information) stands for the National Center for Biotechnology Information, which is part of the United States [National Library of Medicine](https://en.wikipedia.org/wiki/National_Library_of_Medicine) (NLM), a branch of the [National Institutes of Health](https://en.wikipedia.org/wiki/National_Institutes_of_Health) (NIH). NCBI is a public repository that provides free access to a vast collection of biological data, including nucleotide and protein sequences, gene expression data, and biomedical literature.

[GenBank](https://en.wikipedia.org/wiki/GenBank) is a public database maintained by [NCBI](https://en.wikipedia.org/wiki/National_Center_for_Biotechnology_Information) that contains annotated DNA and RNA sequences from a wide range of organisms. It is one of the largest and most widely used nucleotide sequence databases in the world. GenBank includes sequences generated by various high-throughput sequencing technologies as well as traditional Sanger sequencing, and it provides tools for searching and downloading sequence data, as well as for submitting new sequences to the database. GenBank is a valuable resource for researchers in fields such as genomics, molecular biology, evolutionary biology, and biotechnology.


---

## RESOURCES

[NCBI GENBANK WEBSITE](https://www.ncbi.nlm.nih.gov/)  

[`rentrez` vignette](https://cran.r-project.org/web/packages/rentrez/vignettes/rentrez_tutorial.html)

---

## BACKGROUND

[Portunus pelagicus](https://en.wikipedia.org/wiki/Portunus_pelagicus) is a species of swimming crab found in the Indo-West Pacific region, including the Indian Ocean, the Persian Gulf, and the coasts of Southeast Asia and northern Australia. It is commonly known as the blue swimming crab, as it has a distinctive blue coloration on its claws and legs. Portunus pelagicus is an important commercial species and is heavily exploited in many parts of its range for its meat, which is highly valued in local and international markets. It is also a popular seafood item in many countries and is used in a variety of dishes such as crab cakes, soups, and salads.


The COI [barcoding gene](https://en.wikipedia.org/wiki/DNA_barcoding), also known as the [mitochondrial cytochrome c oxidase subunit I gene](https://en.wikipedia.org/wiki/Cytochrome_c_oxidase_subunit_I), is a DNA region that is commonly used as a DNA barcode for species identification and discovery. This gene is found in the mitochondria and it codes for a protein involved in the electron transport chain of cellular respiration. The COI gene has a highly conserved core region and variable flanking regions, making it useful for comparing among a wide range of species. DNA barcoding using the COI gene has become a widely used tool for biodiversity research, species identification, and conservation biology, as it allows for rapid and accurate identification of species using DNA sequences.

DNA barcoding is a technique that uses short DNA sequences from a standardized region of the genome to identify and differentiate species. The [mitochondrial cytochrome c oxidase subunit I (COI)](https://en.wikipedia.org/wiki/Cytochrome_c_oxidase_subunit_I) gene is the most commonly used marker for DNA barcoding due to its highly conserved core region and variable flanking regions. DNA barcoding has become an essential tool for [biodiversity research](https://en.wikipedia.org/wiki/Biodiversity), [species identification](https://en.wikipedia.org/wiki/Species_identification), and [conservation biology](https://en.wikipedia.org/wiki/Conservation_biology), as it allows for rapid and accurate identification of species using DNA sequences. DNA barcoding is widely used in various fields such as [ecology](https://en.wikipedia.org/wiki/Ecology), [evolutionary biology](https://en.wikipedia.org/wiki/Evolutionary_biology), and [forensics](https://en.wikipedia.org/wiki/Forensic_science).




---

## Querying NCBI GenBank using R

### Step 1: Install the necessary packages

The first step is to install the necessary packages that you will need to access NCBI GenBank and perform queries using R. The two main packages that you will need are rentrez and seqinr. You can install them by running the following code in your R console:

```r
install.packages("rentrez")
install.packages("seqinr")
```

### Step 2: Load the necessary packages

Once you have installed the packages, you need to load them into your R session using the following code:

```r
library(rentrez)
library(seqinr)
```

### Step 3: Construct a search query

The next step is to construct a search query that will retrieve the sequence data you are interested in. You can use the entrez_search function from the rentrez package to do this. For example, if you want to search for all sequences from the species Portunus pelagicus with the keyword "COI", you can use the following code:

```r
search_results <- 
    entrez_search(db = "nucleotide", 
    term = "Portunus pelagicus[orgn] AND COI")
```

### Step 4: Retrieve the IDs of the search results

Once you have constructed your search query, you can use the search_query$ids command to retrieve the IDs of the search results. For example:

```r
ids <- search_results$ids
```

### Step 5: Retrieve the sequence data

Finally, you can use the entrez_fetch function from the rentrez package to retrieve the sequence data for the IDs you are interested in. For example, to retrieve the sequence data for the first 10 IDs, you can use the following code:

```r
sequences <- 
    entrez_fetch(db = "nucleotide", 
                 id = ids[1:10], 
                 rettype = "fasta")
```

### Step 6: Analyze the sequence data

Once you have retrieved the sequence data, you can analyze it using the various functions provided by the seqinr package. For example, to compute the GC content of the sequences, you can use the following code:

```r
gc_content <- 
    sapply(
        read.fasta(
            textConnection(sequences)
        ), 
        GC
	)
```

This will compute the GC content for each of the sequences and store the results in a vector called gc_content.




---

_I totally used AI to make this!  [ChatGPT Feb 13 Version](https://help.openai.com/en/articles/6825453-chatgpt-release-notes)_